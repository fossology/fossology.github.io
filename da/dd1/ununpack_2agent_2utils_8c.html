<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FOSSology: src/ununpack/agent/utils.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../fossology-logo.gif"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FOSSology
   &#160;<span id="projectnumber">4.6.0-rc1</span>
   </div>
   <div id="projectbrief">Open Source License Compliance by Open Source Software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('da/dd1/ununpack_2agent_2utils_8c.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">utils.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains all utility functions used by FOSSology.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;ununpack.h&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/df2/externs_8h_source.html">externs.h</a>&quot;</code><br />
<code>#include &quot;regex.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for utils.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/dbd/ununpack_2agent_2utils_8c__incl.png" border="0" usemap="#asrc_2ununpack_2agent_2utils_8c" alt=""/></div>
<map name="asrc_2ununpack_2agent_2utils_8c" id="asrc_2ununpack_2agent_2utils_8c">
<area shape="rect" title="Contains all utility functions used by FOSSology." alt="" coords="1304,5,1453,47"/>
<area shape="rect" href="../../d3/d3f/ununpack_8h_source.html" title=" " alt="" coords="1215,95,1313,121"/>
<area shape="rect" href="../../d2/df2/externs_8h.html" title="Stores all extern variables used by the agent." alt="" coords="1337,95,1420,121"/>
<area shape="rect" title=" " alt="" coords="1445,95,1515,121"/>
<area shape="rect" title=" " alt="" coords="885,393,955,420"/>
<area shape="rect" title=" " alt="" coords="592,244,664,271"/>
<area shape="rect" title=" " alt="" coords="793,393,861,420"/>
<area shape="rect" title=" " alt="" coords="126,393,189,420"/>
<area shape="rect" title=" " alt="" coords="392,169,467,196"/>
<area shape="rect" title=" " alt="" coords="1967,393,2041,420"/>
<area shape="rect" title=" " alt="" coords="1649,393,1716,420"/>
<area shape="rect" title=" " alt="" coords="1450,393,1521,420"/>
<area shape="rect" title=" " alt="" coords="1303,393,1374,420"/>
<area shape="rect" title=" " alt="" coords="625,393,689,420"/>
<area shape="rect" title=" " alt="" coords="1103,393,1177,420"/>
<area shape="rect" title=" " alt="" coords="1227,169,1301,196"/>
<area shape="rect" title=" " alt="" coords="213,393,315,420"/>
<area shape="rect" title=" " alt="" coords="1381,244,1467,271"/>
<area shape="rect" title=" " alt="" coords="1427,169,1517,196"/>
<area shape="rect" title=" " alt="" coords="5,393,101,420"/>
<area shape="rect" title=" " alt="" coords="1592,169,1680,196"/>
<area shape="rect" href="../../dc/d31/checksum_8h_source.html" title=" " alt="" coords="918,169,1018,196"/>
<area shape="rect" href="../../d8/d3b/libfossology_8h.html" title="The main FOSSology C library." alt="" coords="1145,244,1255,271"/>
<area shape="rect" href="../../d0/d42/ununpack-ar_8h_source.html" title=" " alt="" coords="1888,169,2003,196"/>
<area shape="rect" href="../../d4/dbe/ununpack-disk_8h_source.html" title=" " alt="" coords="2027,169,2157,196"/>
<area shape="rect" href="../../dc/dd2/ununpack-iso_8h_source.html" title=" " alt="" coords="2181,169,2302,196"/>
<area shape="rect" href="../../d7/d9b/ununpack-zstd_8h_source.html" title=" " alt="" coords="2326,169,2455,196"/>
<area shape="rect" title=" " alt="" coords="339,393,410,420"/>
<area shape="rect" href="../../dc/d81/libfossscheduler_8h_source.html" title=" " alt="" coords="1523,319,1661,345"/>
<area shape="rect" href="../../dc/df8/fossconfig_8h.html" title="FOSSology library to read config file." alt="" coords="979,393,1079,420"/>
<area shape="rect" href="../../d1/dd3/libfossrepo_8h_source.html" title=" " alt="" coords="659,319,765,345"/>
<area shape="rect" href="../../d2/d5f/libfossdb_8h_source.html" title=" " alt="" coords="1253,319,1347,345"/>
<area shape="rect" href="../../d8/d2f/libfossagent_8h_source.html" title=" " alt="" coords="1837,319,1952,345"/>
<area shape="rect" href="../../d5/da6/sqlCopy_8h_source.html" title=" " alt="" coords="1094,319,1178,345"/>
<area shape="rect" href="../../d4/d4c/libfossdbmanager_8h_source.html" title=" " alt="" coords="1741,393,1891,420"/>
<area shape="rect" title=" " alt="" coords="1774,468,1858,495"/>
<area shape="rect" title=" " alt="" coords="1545,393,1625,420"/>
<area shape="rect" title=" " alt="" coords="1296,468,1355,495"/>
<area shape="rect" title=" " alt="" coords="1425,468,1500,495"/>
<area shape="rect" title=" " alt="" coords="434,393,505,420"/>
<area shape="rect" title=" " alt="" coords="529,393,601,420"/>
<area shape="rect" title=" " alt="" coords="714,393,769,420"/>
<area shape="rect" title=" " alt="" coords="2116,393,2199,420"/>
</map>
</div>
</div>
<p><a href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:af84fb91f73047dadd657ae4d87cdbc3f"><td class="memItemLeft" align="right" valign="top"><a id="af84fb91f73047dadd657ae4d87cdbc3f"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#af84fb91f73047dadd657ae4d87cdbc3f">BITS</a> { <b>BITS_PROJECT</b> = 27
, <b>BITS_ARTIFACT</b> = 28
, <b>BITS_CONTAINER</b> = 29
 }</td></tr>
<tr class="memdesc:af84fb91f73047dadd657ae4d87cdbc3f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="d6/d88/structFile.html">File</a> mode BITS. <br /></td></tr>
<tr class="separator:af84fb91f73047dadd657ae4d87cdbc3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad3f39d9f28b78932107203b1e6250828"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#ad3f39d9f28b78932107203b1e6250828">IsInflatedFile</a> (char *FileName, int InflateSize)</td></tr>
<tr class="memdesc:ad3f39d9f28b78932107203b1e6250828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if the file is a compression bomb.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#ad3f39d9f28b78932107203b1e6250828">More...</a><br /></td></tr>
<tr class="separator:ad3f39d9f28b78932107203b1e6250828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac78bfb98ca0076b2346b17dbcdb2d018"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#ac78bfb98ca0076b2346b17dbcdb2d018">SafeExit</a> (int rc)</td></tr>
<tr class="memdesc:ac78bfb98ca0076b2346b17dbcdb2d018"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close scheduler and database connections, then exit.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#ac78bfb98ca0076b2346b17dbcdb2d018">More...</a><br /></td></tr>
<tr class="separator:ac78bfb98ca0076b2346b17dbcdb2d018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e479dbd33c75d4a9638fd6b2834f0b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a6e479dbd33c75d4a9638fd6b2834f0b3">RemovePostfix</a> (char *Name)</td></tr>
<tr class="memdesc:a6e479dbd33c75d4a9638fd6b2834f0b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">get rid of the postfix  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a6e479dbd33c75d4a9638fd6b2834f0b3">More...</a><br /></td></tr>
<tr class="separator:a6e479dbd33c75d4a9638fd6b2834f0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab41a430d7bba91eb2865c3f721aec830"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#ab41a430d7bba91eb2865c3f721aec830">InitCmd</a> ()</td></tr>
<tr class="memdesc:ab41a430d7bba91eb2865c3f721aec830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the metahandler CMD table.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#ab41a430d7bba91eb2865c3f721aec830">More...</a><br /></td></tr>
<tr class="separator:ab41a430d7bba91eb2865c3f721aec830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53f5cd208cd8b43e423279bcabf62662"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a53f5cd208cd8b43e423279bcabf62662">TaintString</a> (char *Dest, int DestLen, char *<a class="el" href="../../d2/d7b/test__CopyFile_8c.html#af16413f3af1abd6bf7646374bf12f672">Src</a>, int ProtectQuotes, char *Replace)</td></tr>
<tr class="memdesc:a53f5cd208cd8b43e423279bcabf62662"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protect strings intelligently.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a53f5cd208cd8b43e423279bcabf62662">More...</a><br /></td></tr>
<tr class="separator:a53f5cd208cd8b43e423279bcabf62662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2020639c7c03622a929b1cc72d9a06fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a2020639c7c03622a929b1cc72d9a06fb">Prune</a> (char *Fname, struct stat Stat)</td></tr>
<tr class="memdesc:a2020639c7c03622a929b1cc72d9a06fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a filename and its stat, prune it.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a2020639c7c03622a929b1cc72d9a06fb">More...</a><br /></td></tr>
<tr class="separator:a2020639c7c03622a929b1cc72d9a06fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17dcbc3ce2c260b7ea6d6f30f32c5936"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a17dcbc3ce2c260b7ea6d6f30f32c5936">MkDirs</a> (char *Fname)</td></tr>
<tr class="memdesc:a17dcbc3ce2c260b7ea6d6f30f32c5936"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same as command-line "mkdir -p".  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a17dcbc3ce2c260b7ea6d6f30f32c5936">More...</a><br /></td></tr>
<tr class="separator:a17dcbc3ce2c260b7ea6d6f30f32c5936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a448bdbe43cd0c6546080a43d040d6459"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a448bdbe43cd0c6546080a43d040d6459">MkDir</a> (char *Fname)</td></tr>
<tr class="memdesc:a448bdbe43cd0c6546080a43d040d6459"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smart mkdir.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a448bdbe43cd0c6546080a43d040d6459">More...</a><br /></td></tr>
<tr class="separator:a448bdbe43cd0c6546080a43d040d6459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff24afc956c8b7c00247758f99b2c55d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#aff24afc956c8b7c00247758f99b2c55d">IsDir</a> (char *Fname)</td></tr>
<tr class="memdesc:aff24afc956c8b7c00247758f99b2c55d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a filename, is it a directory?  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#aff24afc956c8b7c00247758f99b2c55d">More...</a><br /></td></tr>
<tr class="separator:aff24afc956c8b7c00247758f99b2c55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0977cf9385aba2916cf6615f14a06526"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a0977cf9385aba2916cf6615f14a06526">IsFile</a> (char *Fname, int Link)</td></tr>
<tr class="memdesc:a0977cf9385aba2916cf6615f14a06526"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a filename, is it a file?  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a0977cf9385aba2916cf6615f14a06526">More...</a><br /></td></tr>
<tr class="separator:a0977cf9385aba2916cf6615f14a06526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e99667665ed6b5b77142ee76c1eeaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#af7e99667665ed6b5b77142ee76c1eeaa">ReadLine</a> (FILE *Fin, char *Line, int MaxLine)</td></tr>
<tr class="memdesc:af7e99667665ed6b5b77142ee76c1eeaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a command from a stream.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#af7e99667665ed6b5b77142ee76c1eeaa">More...</a><br /></td></tr>
<tr class="separator:af7e99667665ed6b5b77142ee76c1eeaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf5744e8ef925e720ae4f1937f3d0fef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#abf5744e8ef925e720ae4f1937f3d0fef">IsExe</a> (char *Exe, int <a class="el" href="../../dc/da7/ununpack__globals_8h.html#a4cbc70c34829a2ba413672310bb6d528">Quiet</a>)</td></tr>
<tr class="memdesc:abf5744e8ef925e720ae4f1937f3d0fef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the executable exists.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#abf5744e8ef925e720ae4f1937f3d0fef">More...</a><br /></td></tr>
<tr class="separator:abf5744e8ef925e720ae4f1937f3d0fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2dc008e70ecfafc4d978118743241df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#ad2dc008e70ecfafc4d978118743241df">CopyFile</a> (char *<a class="el" href="../../d2/d7b/test__CopyFile_8c.html#af16413f3af1abd6bf7646374bf12f672">Src</a>, char *<a class="el" href="../../d2/d7b/test__CopyFile_8c.html#ab9e3da739cc5709282a49940edec2d6b">Dst</a>)</td></tr>
<tr class="memdesc:ad2dc008e70ecfafc4d978118743241df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a file. For speed: mmap and save.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#ad2dc008e70ecfafc4d978118743241df">More...</a><br /></td></tr>
<tr class="separator:ad2dc008e70ecfafc4d978118743241df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b8c43c00c946ec722013356a4f0abc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a64b8c43c00c946ec722013356a4f0abc">ParentWait</a> ()</td></tr>
<tr class="memdesc:a64b8c43c00c946ec722013356a4f0abc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for a child. Sets child status.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a64b8c43c00c946ec722013356a4f0abc">More...</a><br /></td></tr>
<tr class="separator:a64b8c43c00c946ec722013356a4f0abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39fa985a75bbbacabcf9a19ecb139015"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a39fa985a75bbbacabcf9a19ecb139015">CheckCommands</a> (int Show)</td></tr>
<tr class="memdesc:a39fa985a75bbbacabcf9a19ecb139015"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure all commands are usable.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a39fa985a75bbbacabcf9a19ecb139015">More...</a><br /></td></tr>
<tr class="separator:a39fa985a75bbbacabcf9a19ecb139015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0688c932b008471183a29139b4f95678"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a0688c932b008471183a29139b4f95678">RunCommand</a> (char *Cmd, char *CmdPre, char *<a class="el" href="../../d6/d88/structFile.html">File</a>, char *CmdPost, char *Out, char *Where)</td></tr>
<tr class="memdesc:a0688c932b008471183a29139b4f95678"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try a command and return command code.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a0688c932b008471183a29139b4f95678">More...</a><br /></td></tr>
<tr class="separator:a0688c932b008471183a29139b4f95678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a389f500d0ed909322581405e61986bad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a389f500d0ed909322581405e61986bad">InitMagic</a> ()</td></tr>
<tr class="memdesc:a389f500d0ed909322581405e61986bad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open and load Magic file Initializes global MagicCookie.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a389f500d0ed909322581405e61986bad">More...</a><br /></td></tr>
<tr class="separator:a389f500d0ed909322581405e61986bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c20274cfbc6e79860645a68e48eaee4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a3c20274cfbc6e79860645a68e48eaee4">IsDebianSourceFile</a> (char *<a class="el" href="../../d3/d69/ununpack_2agent__tests_2Unit_2run__tests_8c.html#a8f91fce8713dd601ee00a5fcef69c9c7">Filename</a>)</td></tr>
<tr class="memdesc:a3c20274cfbc6e79860645a68e48eaee4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read file to see if it is a Debian source file.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a3c20274cfbc6e79860645a68e48eaee4">More...</a><br /></td></tr>
<tr class="separator:a3c20274cfbc6e79860645a68e48eaee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a763678246cccf1ebecae453554d4bb54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a763678246cccf1ebecae453554d4bb54">OctetType</a> (char *<a class="el" href="../../d3/d69/ununpack_2agent__tests_2Unit_2run__tests_8c.html#a8f91fce8713dd601ee00a5fcef69c9c7">Filename</a>, char *TypeBuf)</td></tr>
<tr class="memdesc:a763678246cccf1ebecae453554d4bb54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Figure out the real type of "octet" files in case we can unarchive them.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a763678246cccf1ebecae453554d4bb54">More...</a><br /></td></tr>
<tr class="separator:a763678246cccf1ebecae453554d4bb54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc07c877878c2fb76b859399bdab6e3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#acc07c877878c2fb76b859399bdab6e3a">FindCmd</a> (char *<a class="el" href="../../d3/d69/ununpack_2agent__tests_2Unit_2run__tests_8c.html#a8f91fce8713dd601ee00a5fcef69c9c7">Filename</a>)</td></tr>
<tr class="memdesc:acc07c877878c2fb76b859399bdab6e3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a file name, determine the type of extraction command. This uses Magic.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#acc07c877878c2fb76b859399bdab6e3a">More...</a><br /></td></tr>
<tr class="separator:acc07c877878c2fb76b859399bdab6e3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cae8a17fc2bf4506f01b1fe34a27ae7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a8cae8a17fc2bf4506f01b1fe34a27ae7">FreeDirList</a> (<a class="el" href="../../df/d8d/structdirlist.html">dirlist</a> *DL)</td></tr>
<tr class="memdesc:a8cae8a17fc2bf4506f01b1fe34a27ae7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a list of files in a directory list.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a8cae8a17fc2bf4506f01b1fe34a27ae7">More...</a><br /></td></tr>
<tr class="separator:a8cae8a17fc2bf4506f01b1fe34a27ae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee9a4674a7cf791d89b2cd3133867ad5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d8d/structdirlist.html">dirlist</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#aee9a4674a7cf791d89b2cd3133867ad5">MakeDirList</a> (char *Fullname)</td></tr>
<tr class="memdesc:aee9a4674a7cf791d89b2cd3133867ad5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a list of files in a directory.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#aee9a4674a7cf791d89b2cd3133867ad5">More...</a><br /></td></tr>
<tr class="separator:aee9a4674a7cf791d89b2cd3133867ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55da88b45401fd659b99672a6d7bc063"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a55da88b45401fd659b99672a6d7bc063">SetDir</a> (char *Dest, int DestLen, char *Smain, char *Sfile)</td></tr>
<tr class="memdesc:a55da88b45401fd659b99672a6d7bc063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a destination directory name.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a55da88b45401fd659b99672a6d7bc063">More...</a><br /></td></tr>
<tr class="separator:a55da88b45401fd659b99672a6d7bc063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123e97e7529242ba3dbce18f4acb7406"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a123e97e7529242ba3dbce18f4acb7406">DebugContainerInfo</a> (<a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *CI)</td></tr>
<tr class="memdesc:a123e97e7529242ba3dbce18f4acb7406"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a <a class="el" href="../../d8/db7/structContainerInfo.html" title="Structure for storing information about a particular file.">ContainerInfo</a> structure.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a123e97e7529242ba3dbce18f4acb7406">More...</a><br /></td></tr>
<tr class="separator:a123e97e7529242ba3dbce18f4acb7406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923f08b91d5f0c80311805a38b711f48"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a923f08b91d5f0c80311805a38b711f48">DBInsertPfile</a> (<a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *CI, char *Fuid)</td></tr>
<tr class="memdesc:a923f08b91d5f0c80311805a38b711f48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a Pfile record. Sets the pfile_pk in CI.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a923f08b91d5f0c80311805a38b711f48">More...</a><br /></td></tr>
<tr class="separator:a923f08b91d5f0c80311805a38b711f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a9ca37309bede5f512c0f7a175dc3b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a2a9ca37309bede5f512c0f7a175dc3b7">TestSCMData</a> (char *sourcefilename)</td></tr>
<tr class="memdesc:a2a9ca37309bede5f512c0f7a175dc3b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search for SCM data in the filename.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a2a9ca37309bede5f512c0f7a175dc3b7">More...</a><br /></td></tr>
<tr class="separator:a2a9ca37309bede5f512c0f7a175dc3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d52d05f4c20dc11777639d71dd663c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a92d52d05f4c20dc11777639d71dd663c">DBInsertUploadTree</a> (<a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *CI, int Mask)</td></tr>
<tr class="memdesc:a92d52d05f4c20dc11777639d71dd663c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert an UploadTree record.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a92d52d05f4c20dc11777639d71dd663c">More...</a><br /></td></tr>
<tr class="separator:a92d52d05f4c20dc11777639d71dd663c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81dc342023f6676d0a8073fcd05b41a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a81dc342023f6676d0a8073fcd05b41a4">AddToRepository</a> (<a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *CI, char *Fuid, int Mask)</td></tr>
<tr class="memdesc:a81dc342023f6676d0a8073fcd05b41a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a <a class="el" href="../../d8/db7/structContainerInfo.html" title="Structure for storing information about a particular file.">ContainerInfo</a> record to the repository AND to the database.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a81dc342023f6676d0a8073fcd05b41a4">More...</a><br /></td></tr>
<tr class="separator:a81dc342023f6676d0a8073fcd05b41a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f8e71c19a3bd44c8c5137dea88ad097"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a0f8e71c19a3bd44c8c5137dea88ad097">DisplayContainerInfo</a> (<a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *CI, int Cmd)</td></tr>
<tr class="memdesc:a0f8e71c19a3bd44c8c5137dea88ad097"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print what can be printed in XML.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a0f8e71c19a3bd44c8c5137dea88ad097">More...</a><br /></td></tr>
<tr class="separator:a0f8e71c19a3bd44c8c5137dea88ad097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c49e113cf48625b240ec7cc92bc7bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a12c49e113cf48625b240ec7cc92bc7bf">RemoveDir</a> (char *dirpath)</td></tr>
<tr class="memdesc:a12c49e113cf48625b240ec7cc92bc7bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all files under dirpath (rm -rf)  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#a12c49e113cf48625b240ec7cc92bc7bf">More...</a><br /></td></tr>
<tr class="separator:a12c49e113cf48625b240ec7cc92bc7bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66e0f9c6692e2344b5c7eff111c3c69"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#ae66e0f9c6692e2344b5c7eff111c3c69">PathCheck</a> (char *DirPath)</td></tr>
<tr class="memdesc:ae66e0f9c6692e2344b5c7eff111c3c69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if path contains a "%U" or "%H". If so, substitute a unique ID for U.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#ae66e0f9c6692e2344b5c7eff111c3c69">More...</a><br /></td></tr>
<tr class="separator:ae66e0f9c6692e2344b5c7eff111c3c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594c64f4f034c6354772a719912c85af"><td class="memItemLeft" align="right" valign="top"><a id="a594c64f4f034c6354772a719912c85af"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>deleteTmpFiles</b> (char *dir)</td></tr>
<tr class="separator:a594c64f4f034c6354772a719912c85af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba9beb1ecae3af72882e6366fa997f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#aaba9beb1ecae3af72882e6366fa997f4">Usage</a> (char *Name, char *Version)</td></tr>
<tr class="memdesc:aaba9beb1ecae3af72882e6366fa997f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display program usage.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#aaba9beb1ecae3af72882e6366fa997f4">More...</a><br /></td></tr>
<tr class="separator:aaba9beb1ecae3af72882e6366fa997f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec3ef5f066149741d722b502e7d76150"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#aec3ef5f066149741d722b502e7d76150">SQLNoticeProcessor</a> (void *arg, const char *message)</td></tr>
<tr class="memdesc:aec3ef5f066149741d722b502e7d76150"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy postgresql notice processor. This prevents Notices from being written to stderr.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#aec3ef5f066149741d722b502e7d76150">More...</a><br /></td></tr>
<tr class="separator:aec3ef5f066149741d722b502e7d76150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace54f405f5bb845211785673bf1f730c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#ace54f405f5bb845211785673bf1f730c">ShouldExclude</a> (char *<a class="el" href="../../d3/d69/ununpack_2agent__tests_2Unit_2run__tests_8c.html#a8f91fce8713dd601ee00a5fcef69c9c7">Filename</a>, const char *ExcludePatterns)</td></tr>
<tr class="memdesc:ace54f405f5bb845211785673bf1f730c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if a file or folder should be excluded.  <a href="../../da/dd1/ununpack_2agent_2utils_8c.html#ace54f405f5bb845211785673bf1f730c">More...</a><br /></td></tr>
<tr class="separator:ace54f405f5bb845211785673bf1f730c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0e1f72c2f96f071689a3b1d6b196a535"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html#a0e1f72c2f96f071689a3b1d6b196a535">SCM_REGEX</a> = &quot;/\\.git|\\.hg|\\.bzr|CVS/ROOT|\\.svn/&quot;</td></tr>
<tr class="separator:a0e1f72c2f96f071689a3b1d6b196a535"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains all utility functions used by FOSSology. </p>

<p class="definition">Definition in file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a81dc342023f6676d0a8073fcd05b41a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81dc342023f6676d0a8073fcd05b41a4">&#9670;&nbsp;</a></span>AddToRepository()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AddToRepository </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *&#160;</td>
          <td class="paramname"><em>CI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a <a class="el" href="../../d8/db7/structContainerInfo.html" title="Structure for storing information about a particular file.">ContainerInfo</a> record to the repository AND to the database. </p>
<p>This modifies the CI record's pfile and ufile indexes! </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CI</td><td></td></tr>
    <tr><td class="paramname">Fuid</td><td>sha1.md5.sha256.size </td></tr>
    <tr><td class="paramname">Mask</td><td>file mode mask </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if added, 0 if already exists! </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01403">1403</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a39fa985a75bbbacabcf9a19ecb139015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fa985a75bbbacabcf9a19ecb139015">&#9670;&nbsp;</a></span>CheckCommands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CheckCommands </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Show</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make sure all commands are usable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Show</td><td>Unused </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void but updates global CMD Status </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00568">568</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="ad2dc008e70ecfafc4d978118743241df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2dc008e70ecfafc4d978118743241df">&#9670;&nbsp;</a></span>CopyFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CopyFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy a file. For speed: mmap and save. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">Src</td><td>Source file path </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Dst</td><td>Destination file path </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if copy worked, 1 if failed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00441">441</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a923f08b91d5f0c80311805a38b711f48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923f08b91d5f0c80311805a38b711f48">&#9670;&nbsp;</a></span>DBInsertPfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DBInsertPfile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *&#160;</td>
          <td class="paramname"><em>CI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fuid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a Pfile record. Sets the pfile_pk in CI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CI</td><td></td></tr>
    <tr><td class="paramname">Fuid</td><td>string of sha1.md5.size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if record exists, 0 if record does not exist. </dd></dl>
<p>&lt; Temporary storage for mimetype fk from DB</p>
<p>&lt; Temporary storage for pfile_sha256 from DB</p>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01115">1115</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a92d52d05f4c20dc11777639d71dd663c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92d52d05f4c20dc11777639d71dd663c">&#9670;&nbsp;</a></span>DBInsertUploadTree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DBInsertUploadTree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *&#160;</td>
          <td class="paramname"><em>CI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert an UploadTree record. </p>
<p>If the tree is a duplicate, then we need to replicate all of the uploadtree records for the tree. This uses Upload_Pk. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CI</td><td></td></tr>
    <tr><td class="paramname">Mask</td><td>mask file mode for ufile_mode </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if tree exists for some other project (duplicate) and 0 if tree does not exist. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01287">1287</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a123e97e7529242ba3dbce18f4acb7406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a123e97e7529242ba3dbce18f4acb7406">&#9670;&nbsp;</a></span>DebugContainerInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DebugContainerInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *&#160;</td>
          <td class="paramname"><em>CI</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a <a class="el" href="../../d8/db7/structContainerInfo.html" title="Structure for storing information about a particular file.">ContainerInfo</a> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CI</td><td><a class="el" href="../../d8/db7/structContainerInfo.html" title="Structure for storing information about a particular file.">ContainerInfo</a> struct to print </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01086">1086</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a0f8e71c19a3bd44c8c5137dea88ad097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f8e71c19a3bd44c8c5137dea88ad097">&#9670;&nbsp;</a></span>DisplayContainerInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DisplayContainerInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/db7/structContainerInfo.html">ContainerInfo</a> *&#160;</td>
          <td class="paramname"><em>CI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Cmd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print what can be printed in XML. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CI</td><td></td></tr>
    <tr><td class="paramname">Cmd</td><td>Command used to create this file (parent) CI-&gt;Cmd = command to be used ON this file (child) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if item is unique, 0 if duplicate. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01458">1458</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="acc07c877878c2fb76b859399bdab6e3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc07c877878c2fb76b859399bdab6e3a">&#9670;&nbsp;</a></span>FindCmd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FindCmd </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a file name, determine the type of extraction command. This uses Magic. </p>
<dl class="section return"><dt>Returns</dt><dd>index to command-type, or -1 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00851">851</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a8cae8a17fc2bf4506f01b1fe34a27ae7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cae8a17fc2bf4506f01b1fe34a27ae7">&#9670;&nbsp;</a></span>FreeDirList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FreeDirList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8d/structdirlist.html">dirlist</a> *&#160;</td>
          <td class="paramname"><em>DL</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a list of files in a directory list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DL</td><td>directory list </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00952">952</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="ab41a430d7bba91eb2865c3f721aec830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41a430d7bba91eb2865c3f721aec830">&#9670;&nbsp;</a></span>InitCmd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitCmd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the metahandler CMD table. </p>
<p>This ensures that:</p><ul>
<li>Every mimetype is loaded</li>
<li>Every mimetype has an DBindex. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00109">109</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a389f500d0ed909322581405e61986bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a389f500d0ed909322581405e61986bad">&#9670;&nbsp;</a></span>InitMagic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitMagic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open and load Magic file Initializes global MagicCookie. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00716">716</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a3c20274cfbc6e79860645a68e48eaee4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c20274cfbc6e79860645a68e48eaee4">&#9670;&nbsp;</a></span>IsDebianSourceFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IsDebianSourceFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read file to see if it is a Debian source file. </p>
<p>Assumes that all Debian source files have a .dsc filename extension. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Filename</td><td><a class="el" href="../../d6/d88/structFile.html">File</a> to open </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if Filename is a Debian source file, else 0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00734">734</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="aff24afc956c8b7c00247758f99b2c55d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff24afc956c8b7c00247758f99b2c55d">&#9670;&nbsp;</a></span>IsDir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IsDir </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a filename, is it a directory? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fname</td><td>file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1=yes, 0=no. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00320">320</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="abf5744e8ef925e720ae4f1937f3d0fef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf5744e8ef925e720ae4f1937f3d0fef">&#9670;&nbsp;</a></span>IsExe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IsExe </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Exe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Quiet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the executable exists. </p>
<p>(Like the command-line "which" but without returning the path.) </p><dl class="section note"><dt>Note</dt><dd>This should only be used on relative path executables. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Exe</td><td>Executable file name </td></tr>
    <tr><td class="paramname">Quiet</td><td>If true, do not write warning on file not found </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if exists, 0 if does not exist. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00394">394</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a0977cf9385aba2916cf6615f14a06526"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0977cf9385aba2916cf6615f14a06526">&#9670;&nbsp;</a></span>IsFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IsFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Link</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a filename, is it a file? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fname</td><td>Path of file to check </td></tr>
    <tr><td class="paramname">Link</td><td>True if should it follow symbolic links </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1=yes, 0=no. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00336">336</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="ad3f39d9f28b78932107203b1e6250828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3f39d9f28b78932107203b1e6250828">&#9670;&nbsp;</a></span>IsInflatedFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IsInflatedFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>FileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>InflateSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test if the file is a compression bomb. </p>
<p>If the size of FileName is a factor of InflateSize more than the size of the directory containing it, then it is a bomb. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FileName</td><td>pathname to file </td></tr>
    <tr><td class="paramname">InflateSize</td><td>Inflation factor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on is one inflated file, 0 on is not </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00041">41</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="aee9a4674a7cf791d89b2cd3133867ad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee9a4674a7cf791d89b2cd3133867ad5">&#9670;&nbsp;</a></span>MakeDirList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d8d/structdirlist.html">dirlist</a>* MakeDirList </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fullname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a list of files in a directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fullname</td><td>Path to top level directory. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the directory list </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00971">971</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a448bdbe43cd0c6546080a43d040d6459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a448bdbe43cd0c6546080a43d040d6459">&#9670;&nbsp;</a></span>MkDir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MkDir </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Smart mkdir. </p>
<p>If mkdir fails, then try running MkDirs. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fname</td><td>file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, 1 on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00304">304</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a17dcbc3ce2c260b7ea6d6f30f32c5936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17dcbc3ce2c260b7ea6d6f30f32c5936">&#9670;&nbsp;</a></span>MkDirs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MkDirs </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same as command-line "mkdir -p". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fname</td><td>file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, 1 on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00249">249</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a763678246cccf1ebecae453554d4bb54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a763678246cccf1ebecae453554d4bb54">&#9670;&nbsp;</a></span>OctetType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OctetType </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>TypeBuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Figure out the real type of "octet" files in case we can unarchive them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Filename</td><td></td></tr>
    <tr><td class="paramname">Static</td><td>buffer to return with new Type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00773">773</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a64b8c43c00c946ec722013356a4f0abc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64b8c43c00c946ec722013356a4f0abc">&#9670;&nbsp;</a></span>ParentWait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ParentWait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait for a child. Sets child status. </p>
<dl class="section return"><dt>Returns</dt><dd>the queue record, or -1 if no more children. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00510">510</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="ae66e0f9c6692e2344b5c7eff111c3c69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66e0f9c6692e2344b5c7eff111c3c69">&#9670;&nbsp;</a></span>PathCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* PathCheck </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>DirPath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if path contains a "%U" or "%H". If so, substitute a unique ID for U. </p>
<p>This substitution parameter must be at the end of the DirPath. Substitute hostname for H. @parm DirPath Directory path. </p><dl class="section return"><dt>Returns</dt><dd>new directory path </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01663">1663</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a2020639c7c03622a929b1cc72d9a06fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2020639c7c03622a929b1cc72d9a06fb">&#9670;&nbsp;</a></span>Prune()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Prune </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat&#160;</td>
          <td class="paramname"><em>Stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a filename and its stat, prune it. </p>
<ul>
<li>Remove anything that is not a regular file or directory</li>
<li>Remove files when hard-link count &gt; 1 (duplicate search)</li>
<li>Remove zero-length files <dl class="section return"><dt>Returns</dt><dd>1=pruned, 0=no change. </dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00218">218</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="af7e99667665ed6b5b77142ee76c1eeaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7e99667665ed6b5b77142ee76c1eeaa">&#9670;&nbsp;</a></span>ReadLine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ReadLine </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>Fin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>MaxLine</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a command from a stream. </p>
<p>Read a line each time from one file.</p>
<p>If the line is empty, then try again. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">Fin</td><td>Input file pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Line</td><td>Output line buffer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MaxLine</td><td>Max line length </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>line length, or -1 of EOF. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00357">357</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a12c49e113cf48625b240ec7cc92bc7bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12c49e113cf48625b240ec7cc92bc7bf">&#9670;&nbsp;</a></span>RemoveDir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RemoveDir </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dirpath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove all files under dirpath (rm -rf) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirpath</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>shell exit code of rm -rf </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01642">1642</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a6e479dbd33c75d4a9638fd6b2834f0b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e479dbd33c75d4a9638fd6b2834f0b3">&#9670;&nbsp;</a></span>RemovePostfix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RemovePostfix </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get rid of the postfix </p>
<p>For example: <code>test.gz --&gt; test</code> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Name</td><td>input file name </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00091">91</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a0688c932b008471183a29139b4f95678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0688c932b008471183a29139b4f95678">&#9670;&nbsp;</a></span>RunCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RunCommand </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CmdPre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>File</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CmdPost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Where</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try a command and return command code. </p>
<p>Command becomes:</p><ul>
<li>&lsquo;Cmd CmdPre '<a class="el" href="../../d6/d88/structFile.html">File</a>&rsquo; CmdPost Out`</li>
<li>If there is a s, then that becomes Where. <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cmd</td><td></td></tr>
    <tr><td class="paramname">CmdPre</td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="../../d6/d88/structFile.html">File</a></td><td></td></tr>
    <tr><td class="paramname">CmdPost</td><td></td></tr>
    <tr><td class="paramname">Out</td><td></td></tr>
    <tr><td class="paramname">Where</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 if command could not run. </dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00622">622</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="ac78bfb98ca0076b2346b17dbcdb2d018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac78bfb98ca0076b2346b17dbcdb2d018">&#9670;&nbsp;</a></span>SafeExit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SafeExit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close scheduler and database connections, then exit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rc</td><td>exit code </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>no return, calls exit() </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00078">78</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a55da88b45401fd659b99672a6d7bc063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55da88b45401fd659b99672a6d7bc063">&#9670;&nbsp;</a></span>SetDir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetDir </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DestLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Smain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Sfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a destination directory name. </p>
<p>This will concatenate Smain and Sfile, but remove and terminating filename. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Dest</td><td>returned directory name </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">DestLen</td><td>size of Dest </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">Smain</td><td>main extraction directory (may be null) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">Sfile</td><td>filename </td></tr>
  </table>
  </dd>
</dl>
<p>NOTE: Someone that embeds "../" within the path can still climb out!</p>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01048">1048</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="ace54f405f5bb845211785673bf1f730c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace54f405f5bb845211785673bf1f730c">&#9670;&nbsp;</a></span>ShouldExclude()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ShouldExclude </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ExcludePatterns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if a file or folder should be excluded. </p>
<p>This function checks whether the supplied file name, <code>Filename</code>, contains any of the substrings listed in the comma-separated string <code>ExcludePatterns</code>. Each pattern is matched directly as a substring; no wildcard or directory-specific matching is performed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Filename</td><td>The name of the file or folder to be examined. </td></tr>
    <tr><td class="paramname">ExcludePatterns</td><td>A comma-separated list of substrings used for determining exclusion. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if a substring match is found (folder is to be excluded), or 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01788">1788</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="aec3ef5f066149741d722b502e7d76150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec3ef5f066149741d722b502e7d76150">&#9670;&nbsp;</a></span>SQLNoticeProcessor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SQLNoticeProcessor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dummy postgresql notice processor. This prevents Notices from being written to stderr. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>unused </td></tr>
    <tr><td class="paramname">message</td><td>unused </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01773">1773</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a53f5cd208cd8b43e423279bcabf62662"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53f5cd208cd8b43e423279bcabf62662">&#9670;&nbsp;</a></span>TaintString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TaintString </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DestLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ProtectQuotes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Replace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Protect strings intelligently. </p>
<p>Prevents filenames containing ' or % or \ from screwing up system() and snprintf(). Even supports a "%s". </p><dl class="section note"><dt>Note</dt><dd>s is assumed to be in single quotes! </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Dest</td><td>Destination to store tainted string </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">DestLen</td><td>Length of Dest </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">Src</td><td>Source string </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ProtectQuotes</td><td>Set to protect quotes for shell </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">Replace</td><td>String to replace with </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, 1 on overflow. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00166">166</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="a2a9ca37309bede5f512c0f7a175dc3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a9ca37309bede5f512c0f7a175dc3b7">&#9670;&nbsp;</a></span>TestSCMData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TestSCMData </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sourcefilename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search for SCM data in the filename. </p>
<p>SCM data is one of these: Git (.git)Data(char *FileName) Mercurial (.hg) Bazaar (.bzr) CVS (CVS/Root) Subversion (.svn) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sourcefilename</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if SCM data is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01225">1225</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a id="aaba9beb1ecae3af72882e6366fa997f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaba9beb1ecae3af72882e6366fa997f4">&#9670;&nbsp;</a></span>Usage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Usage </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Display program usage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Name</td><td>program name </td></tr>
    <tr><td class="paramname">Version</td><td>program version </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l01724">1724</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0e1f72c2f96f071689a3b1d6b196a535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e1f72c2f96f071689a3b1d6b196a535">&#9670;&nbsp;</a></span>SCM_REGEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* SCM_REGEX = &quot;/\\.git|\\.hg|\\.bzr|CVS/ROOT|\\.svn/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>regular expression to detect SCM data </p>

<p class="definition">Definition at line <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html#l00028">28</a> of file <a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_5f27d04085cf5632b5250e7d720a5094.html">ununpack</a></li><li class="navelem"><a class="el" href="../../dir_0ac331944ea22858c41867ea753814de.html">agent</a></li><li class="navelem"><a class="el" href="../../da/dd1/ununpack_2agent_2utils_8c.html">utils.c</a></li>
    <li class="footer">Generated on Wed Oct 29 2025 10:31:31 for FOSSology by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
