<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FOSSology: src/scheduler/agent/database.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../fossology-logo.gif"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FOSSology
   &#160;<span id="projectnumber">4.6.0</span>
   </div>
   <div id="projectbrief">Open Source License Compliance by Open Source Software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d9/dfa/scheduler_2agent_2database_8c.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">database.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Database related operations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="../../de/d9e/agent_8h_source.html">agent.h</a>&gt;</code><br />
<code>#include &lt;database.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/d77/logging_8h_source.html">logging.h</a>&gt;</code><br />
<code>#include &lt;emailformatter.h&gt;</code><br />
<code>#include &lt;libfossdb.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/mman.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d0/df8/sqlstatements_8h_source.html">sqlstatements.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for database.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d68/scheduler_2agent_2database_8c__incl.png" border="0" usemap="#asrc_2scheduler_2agent_2database_8c" alt=""/></div>
<map name="asrc_2scheduler_2agent_2database_8c" id="asrc_2scheduler_2agent_2database_8c">
<area shape="rect" title="Database related operations." alt="" coords="889,5,1038,47"/>
<area shape="rect" href="../../de/d9e/agent_8h.html" title="Header file with agent related operations." alt="" coords="461,169,532,196"/>
<area shape="rect" href="../../d5/d77/logging_8h.html" title="Log related operations." alt="" coords="821,468,903,495"/>
<area shape="rect" href="../../d7/d55/scheduler_2agent_2database_8h_source.html" title=" " alt="" coords="649,169,744,196"/>
<area shape="rect" href="../../d8/d5a/emailformatter_8h_source.html" title=" " alt="" coords="472,95,604,121"/>
<area shape="rect" href="../../d2/d5f/libfossdb_8h_source.html" title=" " alt="" coords="927,468,1021,495"/>
<area shape="rect" title=" " alt="" coords="1001,95,1064,121"/>
<area shape="rect" title=" " alt="" coords="1089,95,1174,121"/>
<area shape="rect" title=" " alt="" coords="1199,95,1301,121"/>
<area shape="rect" href="../../d0/df8/sqlstatements_8h.html" title=" " alt="" coords="1325,95,1452,121"/>
<area shape="rect" href="../../df/ded/host_8h_source.html" title=" " alt="" coords="121,319,184,345"/>
<area shape="rect" href="../../d3/dd1/scheduler_2agent_2scheduler_8h.html" title="Header file for the scheduler." alt="" coords="513,393,609,420"/>
<area shape="rect" title=" " alt="" coords="219,543,278,569"/>
<area shape="rect" title=" " alt="" coords="44,468,123,495"/>
<area shape="rect" href="../../d3/d6a/job_8h_source.html" title=" " alt="" coords="669,244,724,271"/>
<area shape="rect" title=" " alt="" coords="351,244,447,271"/>
<area shape="rect" title=" " alt="" coords="475,543,542,569"/>
<area shape="rect" title=" " alt="" coords="775,543,843,569"/>
<area shape="rect" title=" " alt="" coords="380,543,451,569"/>
<area shape="rect" title=" " alt="" coords="1251,543,1335,569"/>
<area shape="rect" title=" " alt="" coords="476,468,547,495"/>
<area shape="rect" title=" " alt="" coords="571,468,644,495"/>
<area shape="rect" href="../../dc/df8/fossconfig_8h.html" title="FOSSology library to read config file." alt="" coords="199,468,299,495"/>
<area shape="rect" title=" " alt="" coords="675,543,750,569"/>
<area shape="rect" title=" " alt="" coords="961,543,1032,569"/>
<area shape="rect" title=" " alt="" coords="867,543,937,569"/>
<area shape="rect" title=" " alt="" coords="567,543,651,569"/>
<area shape="rect" href="../../dd/d20/event_8h.html" title="Event handling operations." alt="" coords="624,319,695,345"/>
<area shape="rect" title=" " alt="" coords="1151,543,1226,569"/>
<area shape="rect" title=" " alt="" coords="1056,543,1127,569"/>
</map>
</div>
</div>
<p><a href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d17/structemail__replace__args.html">email_replace_args</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d03/structreqcols.html">reqcols</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data type used to check if the database is correct.  <a href="../../db/d03/structreqcols.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a56cc26ddfd79081305d4ead5c5994ee1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>EMAIL_ERROR</b>(...)</td></tr>
<tr class="separator:a56cc26ddfd79081305d4ead5c5994ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70080e93aff51ab5aa31cfc21d3fa658"><td class="memItemLeft" align="right" valign="top"><a id="a70080e93aff51ab5aa31cfc21d3fa658"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a70080e93aff51ab5aa31cfc21d3fa658">EMAIL_BUILD_CMD</a>&#160;&#160;&#160;&quot;%s %<a class="el" href="../../d4/d96/fo__cli_8c.html#a339d22b3e442946380f98ed19e320db2">s</a> -<a class="el" href="../../d4/d96/fo__cli_8c.html#a339d22b3e442946380f98ed19e320db2">s</a> '%<a class="el" href="../../d4/d96/fo__cli_8c.html#a339d22b3e442946380f98ed19e320db2">s</a>' %<a class="el" href="../../d4/d96/fo__cli_8c.html#a339d22b3e442946380f98ed19e320db2">s</a>&quot;</td></tr>
<tr class="memdesc:a70080e93aff51ab5aa31cfc21d3fa658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Email command format. <br /></td></tr>
<tr class="separator:a70080e93aff51ab5aa31cfc21d3fa658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17256595f49d7ecb94970a6f6113da0e"><td class="memItemLeft" align="right" valign="top"><a id="a17256595f49d7ecb94970a6f6113da0e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a17256595f49d7ecb94970a6f6113da0e">DEFAULT_HEADER</a>&#160;&#160;&#160;&quot;FOSSology scan complete\nmessage:\&quot;&quot;</td></tr>
<tr class="memdesc:a17256595f49d7ecb94970a6f6113da0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default email header. <br /></td></tr>
<tr class="separator:a17256595f49d7ecb94970a6f6113da0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad53489072de5472b0f0abb4a85d62ce8"><td class="memItemLeft" align="right" valign="top"><a id="ad53489072de5472b0f0abb4a85d62ce8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#ad53489072de5472b0f0abb4a85d62ce8">DEFAULT_FOOTER</a>&#160;&#160;&#160;&quot;\&quot;&quot;</td></tr>
<tr class="memdesc:ad53489072de5472b0f0abb4a85d62ce8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default email footer. <br /></td></tr>
<tr class="separator:ad53489072de5472b0f0abb4a85d62ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5f7c49f2453dc5e8ae6321b70fc93bc"><td class="memItemLeft" align="right" valign="top"><a id="ac5f7c49f2453dc5e8ae6321b70fc93bc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#ac5f7c49f2453dc5e8ae6321b70fc93bc">DEFAULT_SUBJECT</a>&#160;&#160;&#160;&quot;FOSSology scan complete\n&quot;</td></tr>
<tr class="memdesc:ac5f7c49f2453dc5e8ae6321b70fc93bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default email subject. <br /></td></tr>
<tr class="separator:ac5f7c49f2453dc5e8ae6321b70fc93bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dbabdc5c96a856497c28721430fb3d7"><td class="memItemLeft" align="right" valign="top"><a id="a3dbabdc5c96a856497c28721430fb3d7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a3dbabdc5c96a856497c28721430fb3d7">DEFAULT_COMMAND</a>&#160;&#160;&#160;&quot;/usr/bin/mailx&quot;</td></tr>
<tr class="memdesc:a3dbabdc5c96a856497c28721430fb3d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default email command to use. <br /></td></tr>
<tr class="separator:a3dbabdc5c96a856497c28721430fb3d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb702d8b501669a23aa0ab3b281b9384"><td class="memItemLeft" align="right" valign="top"><a id="abb702d8b501669a23aa0ab3b281b9384"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#abb702d8b501669a23aa0ab3b281b9384">min</a>(x,  y)&#160;&#160;&#160;(x &lt; y ? x : y)</td></tr>
<tr class="memdesc:abb702d8b501669a23aa0ab3b281b9384"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the minimum of x, y. <br /></td></tr>
<tr class="separator:abb702d8b501669a23aa0ab3b281b9384"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a58d7dc324cd38afe829d0b2933f98037"><td class="memItemLeft" align="right" valign="top">static gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a58d7dc324cd38afe829d0b2933f98037">email_replace</a> (const GMatchInfo *<a class="el" href="../../de/d90/structmatch.html">match</a>, GString *ret, <a class="el" href="../../d5/d17/structemail__replace__args.html">email_replace_args</a> *args)</td></tr>
<tr class="memdesc:a58d7dc324cd38afe829d0b2933f98037"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces the variables that are in the header and footer files.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a58d7dc324cd38afe829d0b2933f98037">More...</a><br /></td></tr>
<tr class="separator:a58d7dc324cd38afe829d0b2933f98037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa690687fb9f258108c77808327918828"><td class="memItemLeft" align="right" valign="top">static gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#aa690687fb9f258108c77808327918828">email_checkjobstatus</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, <a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *job)</td></tr>
<tr class="memdesc:aa690687fb9f258108c77808327918828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the database for the status of the job.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#aa690687fb9f258108c77808327918828">More...</a><br /></td></tr>
<tr class="separator:aa690687fb9f258108c77808327918828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cb4ae6571963b1431de3e4f5d9d2c59"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a8cb4ae6571963b1431de3e4f5d9d2c59">email_notification</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, <a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *job)</td></tr>
<tr class="separator:a8cb4ae6571963b1431de3e4f5d9d2c59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e9632824edeae50c3fe2b69b30adf55"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a8e9632824edeae50c3fe2b69b30adf55">email_init</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler)</td></tr>
<tr class="memdesc:a8e9632824edeae50c3fe2b69b30adf55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads information about the email that will be sent for job notifications.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a8e9632824edeae50c3fe2b69b30adf55">More...</a><br /></td></tr>
<tr class="separator:a8e9632824edeae50c3fe2b69b30adf55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b76ad702b12234d240bcd5c536c186c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a4b76ad702b12234d240bcd5c536c186c">check_tables</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler)</td></tr>
<tr class="memdesc:a4b76ad702b12234d240bcd5c536c186c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks that any part of the database used by the scheduler is correct.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a4b76ad702b12234d240bcd5c536c186c">More...</a><br /></td></tr>
<tr class="separator:a4b76ad702b12234d240bcd5c536c186c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5cf75014e38c38c7bdbbae56c46364b"><td class="memItemLeft" align="right" valign="top">static PGconn *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#af5cf75014e38c38c7bdbbae56c46364b">database_connect</a> (gchar *configdir)</td></tr>
<tr class="memdesc:af5cf75014e38c38c7bdbbae56c46364b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and performs error checking for a new database connection.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#af5cf75014e38c38c7bdbbae56c46364b">More...</a><br /></td></tr>
<tr class="separator:af5cf75014e38c38c7bdbbae56c46364b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34886f8e88e794a3b95a82588d4538e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a34886f8e88e794a3b95a82588d4538e5">database_init</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler)</td></tr>
<tr class="separator:a34886f8e88e794a3b95a82588d4538e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d51f5ecadf98ac218cc099be30d22e8"><td class="memItemLeft" align="right" valign="top">PGresult *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a0d51f5ecadf98ac218cc099be30d22e8">database_exec</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, const char *sql)</td></tr>
<tr class="memdesc:a0d51f5ecadf98ac218cc099be30d22e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes an sql statement for the scheduler.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a0d51f5ecadf98ac218cc099be30d22e8">More...</a><br /></td></tr>
<tr class="separator:a0d51f5ecadf98ac218cc099be30d22e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c66a4dd97ad4923805122a5704bbb34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a8c66a4dd97ad4923805122a5704bbb34">database_exec_event</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, char *sql)</td></tr>
<tr class="separator:a8c66a4dd97ad4923805122a5704bbb34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4523447c6f82bd8a287f76f80e278daa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a4523447c6f82bd8a287f76f80e278daa">database_update_event</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, void *unused)</td></tr>
<tr class="memdesc:a4523447c6f82bd8a287f76f80e278daa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the job queue for any new entries.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a4523447c6f82bd8a287f76f80e278daa">More...</a><br /></td></tr>
<tr class="separator:a4523447c6f82bd8a287f76f80e278daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c100bde2d99599c691c0dce4c502a19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a2c100bde2d99599c691c0dce4c502a19">database_reset_queue</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler)</td></tr>
<tr class="memdesc:a2c100bde2d99599c691c0dce4c502a19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets any jobs in the job queue that are not completed.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a2c100bde2d99599c691c0dce4c502a19">More...</a><br /></td></tr>
<tr class="separator:a2c100bde2d99599c691c0dce4c502a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43230accac5f09aabcb20e268bcfbb59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a43230accac5f09aabcb20e268bcfbb59">database_update_job</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, <a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *job, job_status status)</td></tr>
<tr class="memdesc:a43230accac5f09aabcb20e268bcfbb59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the status of a job in the database.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a43230accac5f09aabcb20e268bcfbb59">More...</a><br /></td></tr>
<tr class="separator:a43230accac5f09aabcb20e268bcfbb59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab147074c5d5f48aa1466715ba9c217bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#ab147074c5d5f48aa1466715ba9c217bd">database_job_processed</a> (int j_id, int num)</td></tr>
<tr class="memdesc:ab147074c5d5f48aa1466715ba9c217bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the number of items that a job queue entry has processed.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#ab147074c5d5f48aa1466715ba9c217bd">More...</a><br /></td></tr>
<tr class="separator:ab147074c5d5f48aa1466715ba9c217bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b089e3933a09634ca4930d5d6cf546e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a8b089e3933a09634ca4930d5d6cf546e">database_job_log</a> (int j_id, char *log_name)</td></tr>
<tr class="memdesc:a8b089e3933a09634ca4930d5d6cf546e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enters the name of the log file for a job into the database.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a8b089e3933a09634ca4930d5d6cf546e">More...</a><br /></td></tr>
<tr class="separator:a8b089e3933a09634ca4930d5d6cf546e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c698770d3e7bc532af4a95250791174"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a3c698770d3e7bc532af4a95250791174">database_job_priority</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, <a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *job, int priority)</td></tr>
<tr class="memdesc:a3c698770d3e7bc532af4a95250791174"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the priority of a job queue entry in the database.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a3c698770d3e7bc532af4a95250791174">More...</a><br /></td></tr>
<tr class="separator:a3c698770d3e7bc532af4a95250791174"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6560cb35681d990e6614ec2257125f37"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#a6560cb35681d990e6614ec2257125f37">check_mta_support</a> ()</td></tr>
<tr class="memdesc:a6560cb35681d990e6614ec2257125f37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find s-nail version to check if mta is supported.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#a6560cb35681d990e6614ec2257125f37">More...</a><br /></td></tr>
<tr class="separator:a6560cb35681d990e6614ec2257125f37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7aac36204f94fbff2fe057f0af15dc8"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html#ae7aac36204f94fbff2fe057f0af15dc8">get_email_command</a> (<a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *scheduler, char *user_email)</td></tr>
<tr class="memdesc:ae7aac36204f94fbff2fe057f0af15dc8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d2/de0/classBuild.html" title="make fossology, check for warnings and errors">Build</a> command to run to send email.  <a href="../../d9/dfa/scheduler_2agent_2database_8c.html#ae7aac36204f94fbff2fe057f0af15dc8">More...</a><br /></td></tr>
<tr class="separator:ae7aac36204f94fbff2fe057f0af15dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Database related operations. </p>

<p class="definition">Definition in file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a56cc26ddfd79081305d4ead5c5994ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56cc26ddfd79081305d4ead5c5994ee1">&#9670;&nbsp;</a></span>EMAIL_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EMAIL_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  { \</div>
<div class="line">  WARNING(__VA_ARGS__);    \</div>
<div class="line">  email_notify = 0;        \</div>
<div class="line">  error = NULL; }</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00037">37</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6560cb35681d990e6614ec2257125f37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6560cb35681d990e6614ec2257125f37">&#9670;&nbsp;</a></span>check_mta_support()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_mta_support </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find s-nail version to check if mta is supported. </p>
<dl class="section return"><dt>Returns</dt><dd>1 if mta is supported, 0 if not </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l01039">1039</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a4b76ad702b12234d240bcd5c536c186c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b76ad702b12234d240bcd5c536c186c">&#9670;&nbsp;</a></span>check_tables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void check_tables </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks that any part of the database used by the scheduler is correct. </p>
<p>This has a static list of all tables and the associated columns used by the scheduler. If any changes that affect the tables and columns used by the scheduler are made, this static list should be updated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>the scheduler_t* that holds the connection </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00655">655</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="af5cf75014e38c38c7bdbbae56c46364b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5cf75014e38c38c7bdbbae56c46364b">&#9670;&nbsp;</a></span>database_connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PGconn* database_connect </td>
          <td>(</td>
          <td class="paramtype">gchar *&#160;</td>
          <td class="paramname"><em>configdir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and performs error checking for a new database connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configdir</td><td>the location of the Db.conf file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new database connection </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00749">749</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a0d51f5ecadf98ac218cc099be30d22e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d51f5ecadf98ac218cc099be30d22e8">&#9670;&nbsp;</a></span>database_exec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PGresult* database_exec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sql</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes an sql statement for the scheduler. </p>
<p>This is used in case the database connection is lost. The scheduler requires a connection to the database to correctly operate. So if the connection is ever lost we automatically try to reconnect and if we are unable to, the scheduler will die.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>the scheduler_t* that holds the connection </td></tr>
    <tr><td class="paramname">sql</td><td>the sql that will be performed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the PGresult struct that is returned by PQexec </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00803">803</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a8c66a4dd97ad4923805122a5704bbb34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c66a4dd97ad4923805122a5704bbb34">&#9670;&nbsp;</a></span>database_exec_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_exec_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sql</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000049">Todo:</a></b></dt><dd></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td></td></tr>
    <tr><td class="paramname">sql</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00827">827</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a34886f8e88e794a3b95a82588d4538e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34886f8e88e794a3b95a82588d4538e5">&#9670;&nbsp;</a></span>database_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes any one-time attributes relating to the database. Currently this includes creating the db connection and checking the URL of the FOSSology instance out of the db. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00770">770</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a8b089e3933a09634ca4930d5d6cf546e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b089e3933a09634ca4930d5d6cf546e">&#9670;&nbsp;</a></span>database_job_log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_job_log </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>log_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enters the name of the log file for a job into the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">j_id</td><td>the id number for the relevant job </td></tr>
    <tr><td class="paramname">log_name</td><td>the name of the log file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l01006">1006</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a3c698770d3e7bc532af4a95250791174"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c698770d3e7bc532af4a95250791174">&#9670;&nbsp;</a></span>database_job_priority()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_job_priority </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>priority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Changes the priority of a job queue entry in the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>The scheduler_t* that holds the connection </td></tr>
    <tr><td class="paramname">job</td><td>the job to change the priority for </td></tr>
    <tr><td class="paramname">priority</td><td>the new priority of the job </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l01021">1021</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="ab147074c5d5f48aa1466715ba9c217bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab147074c5d5f48aa1466715ba9c217bd">&#9670;&nbsp;</a></span>database_job_processed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_job_processed </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the number of items that a job queue entry has processed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">j_id</td><td>the id number of the job queue entry </td></tr>
    <tr><td class="paramname">num</td><td>the number of items processed in total </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00992">992</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a2c100bde2d99599c691c0dce4c502a19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c100bde2d99599c691c0dce4c502a19">&#9670;&nbsp;</a></span>database_reset_queue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_reset_queue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets any jobs in the job queue that are not completed. </p>
<p>This is to make sure that any jobs that were running with the scheduler shutdown are run correctly when it starts up again. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00931">931</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a4523447c6f82bd8a287f76f80e278daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4523447c6f82bd8a287f76f80e278daa">&#9670;&nbsp;</a></span>database_update_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_update_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>unused</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the job queue for any new entries. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>The scheduler_t* that holds the connection </td></tr>
    <tr><td class="paramname">unused</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00841">841</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a43230accac5f09aabcb20e268bcfbb59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43230accac5f09aabcb20e268bcfbb59">&#9670;&nbsp;</a></span>database_update_job()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void database_update_job </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">job_status&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the status of a job in the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>The scheduler_t* that holds the connection </td></tr>
    <tr><td class="paramname">job</td><td>job_t* object for the job </td></tr>
    <tr><td class="paramname">status</td><td>the new status of the job </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00945">945</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="aa690687fb9f258108c77808327918828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa690687fb9f258108c77808327918828">&#9670;&nbsp;</a></span>email_checkjobstatus()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static gint email_checkjobstatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks the database for the status of the job. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>Current scheduler reference </td></tr>
    <tr><td class="paramname">job</td><td>The job to check for the job status on </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0: job is not finished, 1: job has finished, 2: job has failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00365">365</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a8e9632824edeae50c3fe2b69b30adf55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e9632824edeae50c3fe2b69b30adf55">&#9670;&nbsp;</a></span>email_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void email_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads information about the email that will be sent for job notifications. </p>
<p>This loads the header and footer configuration files, loads the subject and client info, and compiles the regex that is used to replace variables in the header and footer files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">scheduler</td><td>Current scheduler to init </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void, no return </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00557">557</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a8cb4ae6571963b1431de3e4f5d9d2c59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cb4ae6571963b1431de3e4f5d9d2c59">&#9670;&nbsp;</a></span>email_notification()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void email_notification </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d68/structjob__t.html">job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sends an email notification that a particular job has completed correctly. This compiles the email based upon the header file, footer file, and the job that just completed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>Current scheduler reference </td></tr>
    <tr><td class="paramname">job</td><td>The job that just finished </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void, no return </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00429">429</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="a58d7dc324cd38afe829d0b2933f98037"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58d7dc324cd38afe829d0b2933f98037">&#9670;&nbsp;</a></span>email_replace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static gboolean email_replace </td>
          <td>(</td>
          <td class="paramtype">const GMatchInfo *&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GString *&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d17/structemail__replace__args.html">email_replace_args</a> *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Replaces the variables that are in the header and footer files. </p>
<p>This is a callback function that is passed to the glib function g_regex_replace_eval(). This reads what was matched by the regex and then appends the correct information onto the GString that is passed to the function.</p>
<p>Variables:<br  />
 $UPLOADNAME<br  />
 $BROWSELINK<br  />
 $SCHEDULERLOG<br  />
 $UPLOADFOLDERNAME<br  />
 $JOBRESULT<br  />
 $JOBQUEUELINK<br  />
 $AGENTSTATUS<br  />
 $DB.table.column [not implemented]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">match</td><td>the regex match that glib found </td></tr>
    <tr><td class="paramname">ret</td><td>the GString* that results should be appended to. </td></tr>
    <tr><td class="paramname">args</td><td>The email replace arguments with foss url and job reference </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>always FALSE so that g_regex_replace_eval() will continue </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000048">Todo:</a></b></dt><dd>needs implementation of $DB.table.column </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l00084">84</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
<a id="ae7aac36204f94fbff2fe057f0af15dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7aac36204f94fbff2fe057f0af15dc8">&#9670;&nbsp;</a></span>get_email_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_email_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3c/structscheduler__t.html">scheduler_t</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>user_email</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="../../d2/de0/classBuild.html" title="make fossology, check for warnings and errors">Build</a> command to run to send email. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scheduler</td><td>Current scheduler object </td></tr>
    <tr><td class="paramname">user_email</td><td>Email id to send mail to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The command to run </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html#l01073">1073</a> of file <a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c_source.html">database.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_dc96eb697a66e01ba190c271f9e8ccc9.html">scheduler</a></li><li class="navelem"><a class="el" href="../../dir_996c7118294fd09b8484818795181f68.html">agent</a></li><li class="navelem"><a class="el" href="../../d9/dfa/scheduler_2agent_2database_8c.html">database.c</a></li>
    <li class="footer">Generated on Fri Feb 20 2026 09:25:16 for FOSSology by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
